<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Admin Login</title>
<link rel="stylesheet" href="style.css">

<script type="module" src="./config.js"></script>
<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

<div class="login-wrapper">
    <div class="login-box">
        <h2>Admin Login</h2>
        <div class="form-group">
            <input id="email" type="text" placeholder="Enter Email">
        </div>
        <div class="form-group">
            <input id="password" type="password" placeholder="Enter Password">
        </div>
        <button id="loginBtn" style="width:100%">Login</button>
    </div>
</div>

<script type="module">
import { db } from "./config.js"
import { collection, getDocs } from "https://www.gstatic.com/firebasejs/10.12.3/firebase-firestore.js"

if(localStorage.getItem("admin_active")) location = "index.html"

const email = document.getElementById("email")
const password = document.getElementById("password")

document.getElementById("loginBtn").onclick = async () => {
    const snap = await getDocs(collection(db,"admin"))
    let ok = false

    snap.forEach(d=>{
        const x = d.data()
        if(x.email === email.value && x.password === password.value){
            ok = true
        }
    })

    if(ok){
        localStorage.setItem("admin_active","ACTIVE")
        location = "index.html"
    } else {
        Swal.fire("Incorrect email or password")
    }
}

document.addEventListener('keypress', (e) => {
    if(e.key === 'Enter') {
        document.getElementById("loginBtn").click()
    }
})
</script>